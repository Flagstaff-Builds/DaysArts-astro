---
import { getCollection, type CollectionEntry } from "astro:content";
import Main from "../../components/html-structure/Main.astro";
import Layout from "../../layouts/Layout.astro";
import { Image } from "astro:assets";

export const getStaticPaths = async () => {
  const blogEntries = await getCollection("blog");
  const paths = blogEntries.map((blogEntry) => ({
    params: { slug: blogEntry.slug },
    props: { blog: blogEntry }
  }))
  return paths;
}

type Props = {
  blog: CollectionEntry<'blog'>;
}

const { blog } = Astro.props;
const { Content } = await blog.render();
---


<Layout title="Blog | Site title">
  <Main>
    <h2 class="text-4xl">{blog.data.title}</h2>

    {blog.data.image && (
      <Image
        src={blog.data.image}
        format="avif"
        quality="mid"
        width={1024}
        height={1024 / 1.5}
        alt={`${blog.data.title} image`}
        class="rounded-2xl shadow-xl mb-4 aspect-thumbnail object-cover"
      />
    )}

    <div class="prose prose-2xl overflow-visible relative mb-20">
      <Content />
    </div>

    <a href="/blog">Go back to all blogs</a>
  </Main>
</Layout>